<!DOCTYPE html>
<html lang="ko">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <style>
      html, body {
         margin: 0;
         padding: 0;
      }
      div {
         box-sizing: border-box;
         max-width: 100%;
      }
      #field {
         width: calc(100vh / 1.5);
         height: 100vh;
         max-height: 768px;
         position: absolute;
         left: 50%;
         top: 50%;
         transform: translate(-50%, -50%);
         background-image: url("poker-table-mat.png");
      }
      #selection {
         display: flex;
         width: 70%;
         height: 20%;
         position: absolute;
         left: 50%;
         bottom: 10%;
         transform: translateX(-50%);
         gap: 40px;
      }
      #bot-choice {
         top: 10%;
         left: 50%;
         transform: translateX(-50%);
         position: absolute;
         width: 20%;
         height: 20%;
         border: 3px solid black;
         background-image: url("기본.png");
         background-size: cover;
         opacity: 0.5;
      }
      .selections {
         flex: 1;
         border: 3px solid black;
      }
      #rock {
         background-image: url("바위.PNG");
         background-size: cover;
         pointer-events: none;
         opacity: 0.5;
      }
      #paper {
         background-image: url("보.PNG");
         background-size: cover;
         pointer-events: none;
         opacity: 0.5;
      }
      #scissors {
         background-image: url("가위.PNG");
         background-size: cover;
         pointer-events: none;
         opacity: 0.5;
      }
      #starting {
         display: flex;
         justify-content: center;
         align-items: center;
         position: absolute;
         left: 50%;
         top: 50%;
         transform: translate(-50%, -50%);
         width: 25%;
         height: 7%;
         border: 3px solid black;
         border-radius: 5px;
         background-color: aqua;
         text-align: center;
         font-size: 1.5em;
         user-select: none;
         cursor: pointer;
      }
      #token {
         display: flex;
         flex-direction: row;
         align-items: center;
         justify-content: center;
         position: absolute;
         width: 15vw;
         height: 15vh;
         top: 0;
         left: -15vw;
         gap: 1vw;
      }
      #seed-money {
         display: flex;
         align-items: center;
         justify-content: center;
         position: absolute;
         width: 12vw;
         height: 10vh;
         top: 15vh;
         left: -13vw;
         border: 3px solid black;
         border-radius: 5px;
         background-color: limegreen;
      }
   </style>
   <title>가위 바위 보 미니게임</title>
</head>
<body>
   <div id="field">
      <div id="token">
         <img src="token.png" alt="Token Image" style="width: 50px; height: 50px;">
         <h3>Tokens: 0</h3>
      </div>
      <div id="seed-money" onclick="tokens = 10000;
                           tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                           seedMoney.style.opacity = '0.5';
                           seedMoney.style.pointerEvents = 'none';">
         <h3>초기자금 얻기</h3>
      </div>
      <div id="starting" onclick="if(startGame()) {
                         startingText.textContent = '게임 중';
                         starting.style.backgroundColor = 'yellow';
                         starting.style.pointerEvents = 'none';
                     }
                         ">
         <strong id="starting-text">시작하기</strong>
      </div>
      <div id="bot-choice"></div>
      <div id="selection">
         <div class="selections" id="rock"></div>
         <div class="selections" id="paper"></div>
         <div class="selections" id="scissors"></div>
      </div>
   </div>
   <script>
      const field = document.getElementById("field");
      const botChoice = document.getElementById("bot-choice");
      const rock = document.getElementById("rock");
      const paper = document.getElementById("paper");
      const scissors = document.getElementById("scissors");
      const starting = document.getElementById("starting");
      const startingText = document.getElementById("starting-text");
      const tokenDisplay = document.querySelector("#token h3");
      const seedMoney = document.getElementById("seed-money");
      let bot;
      let tokens = 0;
      let bet;
      function startGame() {
            if (tokens <= 0) {
               alert("토큰이 부족합니다! 초기 자금을 얻으세요.");
               return false;
            } else {
               paper.style.pointerEvents = "auto";
               scissors.style.pointerEvents = "auto";
               rock.style.pointerEvents = "auto";
               paper.style.opacity = "1";
               scissors.style.opacity = "1";
               rock.style.opacity = "1";
               botChoice.style.opacity = "1";
               bet = Number(prompt("배팅할 토큰의 수를 입력하세요. (최대 " + tokens +", 최소 1):"));
               if (bet === null || isNaN(bet) || bet <= 0 || bet > tokens) {
                  alert("잘못된 입력입니다. 다시 시도하세요.");
                  return false;
               }
               return true;
            }
         }
      function resetGame() {
            botChoice.style.backgroundImage = "url('기본.PNG')";
            botChoice.style.opacity = "0.5";
            rock.style.pointerEvents = "none";
            paper.style.pointerEvents = "none";
            scissors.style.pointerEvents = "none";
            rock.style.opacity = "0.5";
            paper.style.opacity = "0.5";
            scissors.style.opacity = "0.5";
            bot = undefined;
            startingText.textContent = "시작하기";
            starting.style.backgroundColor = "aqua";
            starting.style.pointerEvents = "auto";
            starting.setAttribute("onclick", `if(startGame()) {
                         startingText.textContent = '게임 중';
                         starting.style.backgroundColor = 'yellow';
                         starting.style.pointerEvents = 'none';
                     }`);
      }
         rock.addEventListener("click", () => {
         bot = Math.floor(Math.random() * 3);
         switch (bot) {
            case 0:
               botChoice.style.backgroundImage = "url('바위.PNG')";
               break;
            case 1:
               botChoice.style.backgroundImage = "url('보.PNG')";
               break;
            case 2:
               botChoice.style.backgroundImage = "url('가위.PNG')";
               break;
            }
                  paper.style.pointerEvents = "none";
                  scissors.style.pointerEvents = "none";
                  rock.style.pointerEvents = "none";
                  paper.style.transition = "opacity 0.5s ease";
                  paper.style.opacity = "0.5";
                  scissors.style.transition = "opacity 0.5s ease";
                  scissors.style.opacity = "0.5";
                  new Promise((resolve) => {
                     switch (bot) {
                        case 0:
                           setTimeout(() => {alert("비겼습니다!"); resolve();}, 1000);
                           tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                           break;
                        case 1:
                           setTimeout(() => {alert("졌습니다!"); resolve();}, 1000);
                           tokens -= bet;
                           tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                           break;
                        case 2:
                           setTimeout(() => {alert("이겼습니다!"); resolve();}, 1000);
                           tokens += bet;
                           tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                           break;
                     }
                  }).then(() => {
                     startingText.textContent = "리셋하기"
                     starting.style.backgroundColor = "red";
                     starting.style.pointerEvents = "auto";
                     starting.setAttribute("onclick", "resetGame();");
               });
            });
         paper.addEventListener("click", () => {
         bot = Math.floor(Math.random() * 3);
         switch (bot) {
            case 0:
               botChoice.style.backgroundImage = "url('바위.PNG')";
               break;
            case 1:
               botChoice.style.backgroundImage = "url('보.PNG')";
               break;
            case 2:
               botChoice.style.backgroundImage = "url('가위.PNG')";
               break;
            }
            rock.style.pointerEvents = "none";
            scissors.style.pointerEvents = "none";
            paper.style.pointerEvents = "none";
            rock.style.transition = "opacity 0.5s ease";
            rock.style.opacity = "0.5";
            scissors.style.transition = "opacity 0.5s ease";
            scissors.style.opacity = "0.5";
            new Promise((resolve) => {
               switch (bot) {
                  case 0:
                     setTimeout(() => {alert("이겼습니다!"); resolve();}, 1000);
                     tokens += bet;
                     tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                     break;
                  case 1:
                     setTimeout(() => {alert("비겼습니다!"); resolve();}, 1000);
                     tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                     break;
                  case 2:
                     setTimeout(() => {alert("졌습니다!"); resolve();}, 1000);
                     tokens -= bet;
                     tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                     break;
               }
            }).then(() => {
                  startingText.textContent = "리셋하기"
                  starting.style.pointerEvents = "auto";
                  starting.style.backgroundColor = "red";
                  starting.setAttribute("onclick", "resetGame();");
            });
         });
         scissors.addEventListener("click", () => {
         bot = Math.floor(Math.random() * 3);
         switch (bot) {
            case 0:
               botChoice.style.backgroundImage = "url('바위.PNG')";
               break;
            case 1:
               botChoice.style.backgroundImage = "url('보.PNG')";
               break;
            case 2:
               botChoice.style.backgroundImage = "url('가위.PNG')";
               break;
            }
            rock.style.pointerEvents = "none";
            paper.style.pointerEvents = "none";
            paper.style.pointerEvents = "none";
            rock.style.transition = "opacity 0.5s ease";
            rock.style.opacity = "0.5";
            paper.style.transition = "opacity 0.5s ease";
            paper.style.opacity = "0.5";
            new Promise((resolve) => {
               switch (bot) {
                  case 0:
                     setTimeout(() => {alert("졌습니다!"); resolve();}, 1000);
                     tokens -= bet;
                     tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                     break;
                  case 1:
                     setTimeout(() => {alert("이겼습니다!"); resolve();}, 1000);
                     tokens += bet;
                     tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                     break;
                  case 2:
                     setTimeout(() => {alert("비겼습니다!"); resolve();}, 1000);
                     tokenDisplay.textContent = 'Tokens: ' + `${tokens}`;
                     break;
               }
            }).then(() => {
                  startingText.textContent = "리셋하기"
                  starting.style.backgroundColor = "red";
                  starting.style.pointerEvents = "auto";
                  starting.setAttribute("onclick", "resetGame();");
            });
         });
      
   </script>
</body>
</html>